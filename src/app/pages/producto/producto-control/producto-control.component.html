<ion-content>
  <form [formGroup]="form">
    <div class="flex">
      <ion-list>
        <ion-item fill="outline">
          <ion-label position="floating">Elegir sucursal</ion-label>
          <ion-select 
            formControlName="sucursalSelect" 
            interface="action-sheet" 
            cancelText="CANCELAR"
          >
            <ion-select-option *ngFor="let sucursal of sucursales" [value]="sucursal.id">
              {{sucursal.nombre}}
            </ion-select-option>
          </ion-select>
        </ion-item>
      </ion-list>

      <ion-button class="btnCalendar" (click)="openCalendar()">
        <ion-icon name="calendar-outline"></ion-icon>
      </ion-button>
    </div>

    <div *ngIf="selectedRange.fechaInicio && selectedRange.fechaFin" style="text-align: center;">
      <p style="margin-top: 8px; margin-bottom: 8px;">
        <span>Fecha inicio:</span> {{ selectedRange.fechaInicio | date: 'dd/MM/yyyy' }} 
        <span>Fecha fin:</span> {{ selectedRange.fechaFin  | date: 'dd/MM/yyyy'}}
      </p>
    </div>

    <div class="select-center"> 
      <ion-button type="submit" [disabled]="form.invalid" (click)="onBuscarProductos()">Buscar</ion-button> 
      <div>
        <ion-select 
          interface="action-sheet" 
          placeholder="VERIFICAR" 
          cancelText="CANCELAR" 
          formControlName="verificarFilter"
          (ionChange)="setFilter()"
        >
          <ion-select-option value="todos">
            TODOS
          </ion-select-option>
          <ion-select-option value="noVerificado">
            NO VERIFICADO
          </ion-select-option>
          <ion-select-option value="verificado">
            VERIFICADO
          </ion-select-option>
        </ion-select>
      </div>
    </div>
  </form>
  <div class="productoLista">
    <ion-list>
    <ion-item-sliding #slidingItem
      *ngFor="let productos of productosFiltrados | paginate: { 
        itemsPerPage: 10, currentPage: pagActual 
        }; let i = index"
    >
      <ion-item-options side="start"  >
        <ion-item-option *ngIf="!productos.verificado" color="success" (click)="onCheck(i, slidingItem)"
        >
          <ion-icon slot="icon-only" name="checkmark-sharp"></ion-icon>
        </ion-item-option>
      </ion-item-options>

      <ion-item>
        <img [src]="productos.img" alt="">
        <ion-label (click)="openOnlyView(productos)">
          <h3>{{ productos.descripcion }}</h3>
          <p>Vence: {{ productos.vencimiento | date: 'dd/MM/yyyy' }}</p>
          <p>Cantidad: {{ productos.cantidad }}</p>
        </ion-label>
        <ion-icon *ngIf="productos.verificado || productos.vencimientoVerificado" color="success" name="checkmark-sharp"></ion-icon>
      </ion-item>
    
      <ion-item-options side="end">
        <ion-item-option 
        *ngIf="!productos.verificado" 
        (click)="openModal(productos)"
        color="warning" 
        >
          <ion-icon slot="icon-only" name="pencil-sharp"></ion-icon>
        </ion-item-option>
      </ion-item-options>
    </ion-item-sliding>
    </ion-list>

    <pagination-controls 
      *ngIf="productosFiltrados.length > 0" 
      (pageChange)="pagActual = $event" 
      maxSize="6" 
      previousLabel="Anterior" 
      nextLabel="Siguiente"
      [autoHide]="true"
      boundaryLinks="true"
    >
    </pagination-controls>
  </div>
  <div *ngIf="productosFiltrados.length === 0" class="noProduct">
    <p>SIN PRODUCTOS</p>
  </div>
</ion-content>